<html>
    <head>
        <script src="https://adnew.qq.com/lab/casperTest/mraid.js">
        </script>
    </head>

    <body align="center" style="background-color:rgba(10,10,10,0.5);">
        <script type="text/javascript">
            mraid.addEventListener("ready", handleReadyState);
            function handleReadyState(){
                var ad = document.getElementById('infobar');
                ad.innerHTML = "Ad is in ready state";
            }
        </script>
        <div id="infobar" div="" style="color:#FF0000;font-size: 80px">
 "<style type="\&quot;text/css\&quot;">body {background-color: red;}</style>"
        </div>
		<button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_setShareData()">
            setShareData
        </button>
		<button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_pause()">
            pause
        </button>
		<button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_resume()">
            resume
        </button>
        <button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_startMicrForReco()">
            startMicrForReco
        </button>
        <button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_startMicrForData()">
            startMicrForData
        </button>
        <button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_startMicOnlyVolume()">
            startMicOnlyVolume
        </button>
        <button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_startMicOnlyRecord()">
            startMicOnlyRecord
        </button>
        <button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_endMic()">
            endMic
        </button>
		<button type="button" style="height:60px;width:400px;font-size:40px;" onclick="clicked_endMicrInjectWay()">
            endMicrInjectWay
        </button>
        <audio id="audio" src="file:///cache/2.aac" controls="controls">
        </audio>
        <script>
		var reco = false;
			function clicked_setShareData(){
                mraid.extend.setShareData('{"img_url":"http://wa.gtimg.com/201412/23/q_D_20141223170231.jpg","title":"我是title","desc":"我是摘要","link":"http://v.qq.com?name=echo_test"}');
			}
			
		    function clicked_pause(){
                var v = mraid.mainVideo.pause();
            }
			function clicked_resume(){
                var v = mraid.mainVideo.resume();
            }
            function clicked_startMicrForReco(){
                console.log("startMicrophone");
                mraid.startMic("microphoneFailedCallback", "microphoneVolumeCallback", "microphoneRecordDataCallback", true);
            }
            function clicked_startMicrForData(){
                console.log("startMicrophone");
                mraid.startMic("microphoneFailedCallback", "microphoneVolumeCallback", "microphoneRecordDataCallback", false);
            }
            
            function clicked_startMicOnlyVolume(){
                console.log("startMicrophone");
                mraid.startMic("microphoneFailedCallback", "microphoneVolumeCallback", "", true);
            }
            
            function clicked_startMicOnlyRecord(){
                console.log("startMicrophone");
                mraid.startMic("microphoneFailedCallback", "", "microphoneRecordDataCallback", true);
            }
            
            function clicked_endMic(){
                console.log("endMicrophone");
                mraid.endMic();
            }
			function clicked_endMicrInjectWay(){
                console.log("endMicrophoneForBase64InjectWay");
                mraid.endMic(true);
            }
            function microphoneFailedCallback(errMsg){
                console.log("startMicFailed:" + errMsg);
                alert("startMicFailed:" + errMsg);
            }
            
            function microphoneVolumeCallback(decibel){
                console.log("voice" + decibel);
                var ad = document.getElementById('infobar');
                ad.innerHTML = decibel;
            }
            
            function microphoneRecordDataCallback(data){
                
                console.log("data:" + data);
                alert(data);
                //audio.src = file;
                //audio.play();
				if(!reco) {
					//$("#audio").attr("src", "data:audio/wav;base64," + data);
					//$("#audio").attr("autoplay", "true");
					//$("#audio")[0].play();
					audio = document.getElementById('audio');
					audio.src = "data:audio/wav;base64," + data;
					audio.play();
				}
            }
        </script>
    

</body></html>
